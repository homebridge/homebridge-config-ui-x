<div class="d-flex justify-content-between">
  <h3 class="primary-text m-0">
    {{ 'menu.settings.title' | translate }}
  </h3>
  <button class="btn btn-primary waves-effect m-0" *ngIf="saved" routerLink="/restart"
    [translate]="'platform.docker.settings.button_restart_required'"
    [attr.aria-label]="'platform.docker.settings.button_restart_required' | translate">Restart Required</button>
</div>

<div class="mb-3">
  <h5 class="primary-text mt-3">General</h5>
  <ul class="list-group mt-2">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'menu.label_settings_ui' | translate }}
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" (click)="openUiSettings()">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'menu.config_json_editor' | translate }}
      </span>
      <a class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" routerLink="/config">
        <i class="fas fa-fw fa-cog"></i>
      </a>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'backup.title_backup' | translate }}
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" (click)="openBackupModal()">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'backup.title_restore' | translate }}
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" (click)="openRestoreModal()">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'menu.tooltip_user_accounts' | translate }}
      </span>
      <a class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" routerLink="/users">
        <i class="fas fa-fw fa-cog"></i>
      </a>
    </li>
  </ul>
</div>

<!-- ALL USERS -->
<div class="mb-3">
  <h5 class="primary-text mt-3" translate="settings.network.title_network"></h5>

  <ul class="list-group mt-2">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        <div>{{ 'settings.network.title_network_interfaces' | translate }}
          <a href="javascript:void(0)" ngbTooltip="{{ 'settings.network.message_network_interface_one' | translate }}">
            <i class="fas fa-fw fa-info-circle primary-text"></i>
          </a>
        </div>

        <span *ngFor="let adapter of bridgeNetworkAdapters">
          <span class="badge badge-pill mr-1"
            [ngbTooltip]="adapter.missing ? 'Not Connected' : adapter.ip4 || adapter.ip6" placement="bottom-left"
            openDelay="150" [ngClass]="{'badge-danger': adapter.missing, 'badge-info': !adapter.missing}">
            <i class="fas fa-fw fa-exclamation-triangle" *ngIf="adapter.missing"></i>
            {{ adapter.iface }}
          </span>
        </span>
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" [translate]="'reset.title_clear_cached_accessories'"
        (click)="selectNetworkInterfaces()" [disabled]="!availableNetworkAdapters.length"
        [attr.aria-label]="'settings.network.title_network_interfaces' | translate">
        <i class="fas fa-fw fa-cog" [ngClass]="{ 'fa-pulse': !availableNetworkAdapters.length }"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.mdns_advertiser' | translate }}
        <a href="javascript:void(0)" ngbTooltip="{{ 'settings.mdns_advertiser_help' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <div>
        <select class="custom-select" [formControl]="legacyMdnsFormControl"
          [attr.aria-label]="'settings.mdns_advertiser' | translate">
          <option value="bonjour-hap">Bonjour HAP</option>
          <option value="avahi" *ngIf="showAvahiMdnsOption">Avahi</option>
          <option value="resolved" *ngIf="showResolvedMdnsOption">systemd-resolved (experimental)</option>
          <option value="ciao">Ciao</option>
        </select>
      </div>
    </li>
  </ul>
</div>

<!-- SERVICE MODE USERS ONLY -->
<form class="mt-3 mb-3" novalidate [formGroup]="serviceForm" *ngIf="$settings.env.serviceMode">

  <h5 class="primary-text">{{ 'settings.title_startup_options' | translate }}</h5>

  <ul class="list-group">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>{{ 'settings.startup.debug' | translate }} <code>-D</code></span>
      <input type="checkbox" class="rendux-input" id="homebridgeDebugMode" formControlName="HOMEBRIDGE_DEBUG"
        [attr.aria-label]="'settings.startup.debug' | translate">
      <label for="homebridgeDebugMode" class="rendux-label ml-3" style="min-width: 45px;"></label>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span>
        {{ 'settings.startup.insecure_1' | translate }} ({{ 'settings.startup.insecure_2' | translate }})
        <code>-I</code>
      </span>
      <input type="checkbox" class="rendux-input" id="homebridgeInsecureMode" formControlName="HOMEBRIDGE_INSECURE"
        [attr.aria-label]="'settings.startup.insecure_1' | translate">
      <label for="homebridgeInsecureMode" class="rendux-label ml-3" style="min-width: 45px;"></label>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center" *ngIf="$settings.env.serviceMode">
      <span>{{ 'settings.startup.keep_accessories' | translate }} <code>-K</code></span>
      <input type="checkbox" class="rendux-input" id="homebridgeKeepOrphans" formControlName="HOMEBRIDGE_KEEP_ORPHANS"
        [attr.aria-label]="'settings.startup.keep_accessories' | translate">
      <label for="homebridgeKeepOrphans" class="rendux-label ml-3" style="min-width: 45px;"></label>
    </li>
  </ul>

  <div class="mt-3" *ngIf="$settings.env.serviceMode">
    <h5 class="primary-text">{{ 'settings.title_environment_variables' | translate }}</h5>

    <ul class="list-group mt-2">
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>
          DEBUG
          <a href="javascript:void(0)"
            ngbTooltip="{{ 'settings.service.debug_tooltip' | translate }}">
            <i class="fas fa-fw fa-info-circle primary-text"></i>
          </a>
        </span>
        <div class="pull-right">
          <input class="form-control form-control-sm" formControlName="ENV_DEBUG" type="text" />
        </div>
      </li>
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>
          NODE_OPTIONS
          <a href="https://nodejs.org/api/cli.html" target="_blank"
            ngbTooltip="{{ 'settings.service.node_tooltip' | translate }}">
            <i class="fas fa-fw fa-info-circle primary-text"></i>
          </a>
        </span>
        <div class="pull-right">
          <input class="form-control form-control-sm" formControlName="ENV_NODE_OPTIONS" type="text" />
        </div>
      </li>
    </ul>
  </div>

</form>

<!-- ALL USERS -->
<div class="mb-3">
  <h5 class="primary-text mt-3">{{ 'reset.title_reset' | translate }}</h5>

  <div class="alert alert-info" role="alert">
    {{ 'settings.reset.help' | translate }}
  </div>

  <ul class="list-group mt-2">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'reset.title_unpair_bridges_cameras_tv_external_accessories' | translate }}
        <a href="javascript:void(0)"
          ngbTooltip="{{ 'reset.message_unpair_bridges_cameras_tv_external_accessories' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" (click)="unpairAccessory()"
        [attr.aria-label]="'reset.title_unpair_bridges_cameras_tv_external_accessories' | translate">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'reset.title_reset_homebridge_accessory' | translate | titlecase }}
        <a href="javascript:void(0)" ngbTooltip="{{ 'reset.message_reset_will_unpair_from_homekit' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;" (click)="resetHomebridgeState()"
        [attr.aria-label]="'reset.title_reset_homebridge_accessory' | translate">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
  </ul>
</div>

<!-- SERVICE MODE USERS ONLY -->
<div *ngIf="$settings.env.serviceMode" class="pb-3">

  <h5 class="primary-text mt-3">{{ 'settings.title_manage_cached_accessories' | translate }}</h5>

  <div class="alert alert-info" role="alert">
    {{ 'settings.manage_cache.help' | translate }}
  </div>

  <ul class="list-group mt-2">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'reset.title_clear_cached_accessories_single' | translate }}
        <a href="javascript:void(0)" ngbTooltip="{{ 'reset.message_remove_cached_accessories_single' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;"
        [translate]="'reset.title_clear_cached_accessories_single'" (click)="removeSingleCachedAccessories()"
        [attr.aria-label]="'reset.title_clear_cached_accessories_single' | translate">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'reset.title_clear_cached_accessories' | translate }}
        <a href="javascript:void(0)" ngbTooltip="{{ 'reset.message_remove_cached_accessories' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <button class="btn btn-primary waves-effect m-0 ml-3" style="min-width: 45px;"
        [translate]="'reset.title_clear_cached_accessories'" (click)="removeAllCachedAccessories()"
        [attr.aria-label]="'reset.title_clear_cached_accessories' | translate">
        <i class="fas fa-fw fa-cog"></i>
      </button>
    </li>
  </ul>

  <h5 class="primary-text mt-3">{{ 'settings.title_actions' | translate }}</h5>

  <ul class="list-group mt-2">
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="pr-2">
        {{ 'reset.title_force_restart_hb_service' | translate }}
        <a href="javascript:void(0)" ngbTooltip="{{ 'reset.message_force_restart_hb_help_text' | translate }}">
          <i class="fas fa-fw fa-info-circle primary-text"></i>
        </a>
      </span>
      <span class="red-text text-right">
        Moved to Main Menu &rarr; {{ 'menu.restart.title' | translate }} &rarr; {{ 'menu.hbrestart.confirm_service_button' | translate }}
      </span>
    </li>
  </ul>
</div>
